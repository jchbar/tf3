<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#" class="wf-inactive" lang="en-US"><head profile="http://gmpg.org/xfn/11"><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/cbgapi.loaded_1" async=""></script><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/cbgapi.loaded_0" async=""></script><link rel="stylesheet" type="text/css" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/M9DPSKxMTE9NzdYvLqnMSQUA.css" media="all"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"> <!--[if lt IE 9]><script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script><![endif]--><link rel="stylesheet" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/hs_rsp_popup.css" type="text/css" media="all"><link rel="profile" href="http://gmpg.org/xfn/11"><link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://hayageek.com/feed/"><link rel="alternate" type="text/xml" title="RSS .92" href="http://hayageek.com/feed/rss/"><link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://hayageek.com/feed/atom/"><link rel="pingback" href="http://hayageek.com/xmlrpc.php"><link rel="shortcut icon" href="http://cdn.hayageek.com/wp-content/themes/hayageek/images/favicon.ico.gzip" type="image/x-icon"><title>Two factor authentication with Google Authenticator &amp; PHP</title><meta name="description" content="Two factor authentication with Google Authenticator - How to add Two factor authentication to website using Google Authenticator and PHP"><meta name="keywords" content="Two factor authentication, google authenticator,"><link rel="canonical" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/a_002.htm"><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Two factor authentication with Google Authenticator &amp; PHP"><meta property="og:description" content="Two factor authentication with Google Authenticator - How to add Two factor authentication to website using Google Authenticator and PHP"><meta property="og:url" content="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/"><meta property="og:site_name" content="hayaGeek"><meta property="article:author" content="http://www.facebook.com/hayageek"><meta property="article:tag" content="Google,PHP"><meta property="article:section" content="Coding"><meta property="article:published_time" content="2015-10-20T06:06:13+00:00"><meta property="article:modified_time" content="2015-10-20T06:25:45+00:00"><meta property="og:updated_time" content="2015-10-20T06:25:45+00:00"><meta property="fb:admins" content="100000982091583"><meta property="og:image" content="http://cdn.hayageek.com/wp-content/uploads/2015/10/IMG_5413-169x300.png"><meta name="twitter:card" content="summary"><meta name="twitter:description" content="Two factor authentication with Google Authenticator - How to add Two factor authentication to website using Google Authenticator and PHP"><meta name="twitter:title" content="Two factor authentication with Google Authenticator &amp; PHP"><meta name="twitter:site" content="@hayageek"><meta name="twitter:domain" content="hayaGeek"><meta name="twitter:image:src" content="http://cdn.hayageek.com/wp-content/uploads/2015/10/IMG_5413-169x300.png"><meta name="twitter:creator" content="@hayageek"><link rel="author" href="https://plus.google.com/118255177648356108079"><meta name="author" content="Ravishanker Kusuma"><link rel="stylesheet" id="core3.0-css" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shCore.css" type="text/css" media="all"><link rel="stylesheet" id="core-Default3.0-css" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shCoreDefault.css" type="text/css" media="all"><link rel="stylesheet" id="theme-Default3.0-css" href="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shThemeDefault.css" type="text/css" media="all"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://hayageek.com/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://cdn.hayageek.com/wp-includes/wlwmanifest.xml.gzip"><link rel="shortlink" href="http://hayageek.com/?p=1737"><script type="text/javascript" async="" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/ga.js"></script><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/webfont.js" type="text/javascript" async=""></script><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/ca-pub-0923466578214929.js"></script><script async="" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/bsa.js"></script><script async="" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/adsbygoogle.js"></script><script type="text/javascript" id="_bsap_js_19097822778565d7c7d1cc1bcb8feb6a" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/s_19097822778565d7c7d1cc1bcb8feb6a.js" async="async"></script><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/pro.js" id="_bsap_premium_pro"></script><script type="text/javascript" id="_bsaPRO_js" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/a_002" async="async"></script><script async="" type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/count.js"></script><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/45925.js"></script><script type="text/javascript" id="_bsaPRO_js" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/a" async="async"></script><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/count-data.js"></script><script type="text/javascript" async="" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/embed.js"></script><script type="text/javascript" charset="utf-8" async="" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/button.js"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style><script src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/alfie.js" async="" charset="UTF-8"></script></head><body><div id="wrapper"><div id="tophead-sticky-wrapper" class="sticky-wrapper" style="height: 40px;"><div id="tophead" style=""><div class="container"><div class="topnav"><div class="row"><div class="navleft"><ul class="nav-pills pull-left"><li class="mlogo"><a href="http://hayageek.com/" title="Hayageek Home"><img src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/logo_small.png" alt="HayaGeek" height="24" width="23"></a></li><li class="navsec"><ul><li class=""><a href="http://hayageek.com/">hayaGeek</a></li><li class="cat-item cat-item-5"><a href="http://hayageek.com/category/coding/" title="Programming in PHP, Javascript, VB,C# , Jquery, ">Coding</a></li><li class="cat-item cat-item-4"><a href="http://hayageek.com/category/how/" title="How to guides">How</a></li><li class="cat-item cat-item-81"><a href="http://hayageek.com/category/security/">Security</a></li><li class="cat-item cat-item-8"><a href="http://hayageek.com/category/tutorial/" title="Tutorials  ">Tutorials</a></li></ul></li><li class="dropdown secblock"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" title="Sections"> <i class="icon-star"></i><span class="moff">Sections<i class="icon-down-dir"></i></span> </a><ul class="dropdown-menu"><li class="cat-item cat-item-5"><a href="http://hayageek.com/category/coding/" title="Programming in PHP, Javascript, VB,C# , Jquery, ">Coding</a></li><li class="cat-item cat-item-4"><a href="http://hayageek.com/category/how/" title="How to guides">How</a></li><li class="cat-item cat-item-81"><a href="http://hayageek.com/category/security/">Security</a></li><li class="cat-item cat-item-8"><a href="http://hayageek.com/category/tutorial/" title="Tutorials  ">Tutorials</a></li></ul></li></ul></div><div class="navright"><ul class="nav-pills pull-right"><li class="dropdown"> <a title="Submit" class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-upload"></i> <span class="moff">Submit<i class="icon-down-dir"></i></span></a><ul class="dropdown-menu"><li><a href="http://hayageek.com/submit-tutorial/" title="Submit Tutorial">Submit Tutorial</a></li></ul></li><li class="dropdown moff"> <a title="Follow Us" class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-twitter"></i><i class="icon-facebook"></i><span>Follow Us</span><i class="icon-down-dir"></i></a><ul class="dropdown-menu socialnav"><li class="nfb"><a href="http://www.facebook.com/hayageek" title="Facebook" target="_blank" rel="nofollow"><i class="icon-facebook"></i><span>Facebook</span></a></li><li class="ntwitter"><a href="https://twitter.com/hayageek" title="Twitter" target="_blank" rel="nofollow"><i class="icon-twitter"></i><span>Twitter</span></a></li><li class="ngoogle"><a href="https://plus.google.com/+Hayageek" title="Google+" target="_blank" rel="nofollow"><i class="icon-gplus"></i><span>Google+</span></a></li><li class="npin"><a href="https://pinterest.com/hayageek" title="Pinterest" target="_blank" rel="nofollow"><i class="icon-pinterest"></i><span>Pinterest</span></a></li><li class="nrss"><a href="http://feeds.feedburner.com/hayageek" title="RSS Feed" target="_blank" rel="nofollow"><i class="icon-rss"></i><span>RSS Feed</span></a></li></ul></li><li class="dropdown"> <a title="Help" class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-info"></i> <span class="moff">Help<i class="icon-down-dir"></i></span></a><ul class="dropdown-menu"><li><a href="http://hayageek.com/request-tutorial/">Request Tutorial</a></li><li><a href="http://hayageek.com/contact/">Contact</a></li><li><a href="http://hayageek.com/write-for-us/">Write for Us</a></li><li><a href="https://buysellads.com/buy/detail/209882" rel="nofollow" target="_blank">Advertise</a></li></ul></li><li class="dropdown"><a title="Search on Hayageek" class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-search"></i></a><div class="dropdown-menu ddsearch"><form action="http://hayageek.com/" class="sform"> <input class="s" name="s" placeholder="Search on Hayageek" type="text"></form></div></li></ul></div></div></div></div></div></div><div class="container header"><div class="row"><div class="logopanel"><div class="logoleft columns"><div id="logo"> <a href="http://hayageek.com/" title="Hayageek Home"><img src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/logo.png" alt="Hayageek" height="42" width="114"></a></div><div class="catdrop"> <a class="dropdown-toggle logocat" data-toggle="dropdown" href="#" title="Categories"> <i class="icon-menu"></i> </a><ul class="dropdown-menu"><li class="cat-item cat-item-5"><a href="http://hayageek.com/category/coding/" title="Programming in PHP, Javascript, VB,C# , Jquery, ">Coding</a></li><li class="cat-item cat-item-4"><a href="http://hayageek.com/category/how/" title="How to guides">How</a></li><li class="cat-item cat-item-81"><a href="http://hayageek.com/category/security/">Security</a></li><li class="cat-item cat-item-8"><a href="http://hayageek.com/category/tutorial/" title="Tutorials  ">Tutorials</a></li></ul></div><div class="logosocial"> <span><div class="fb-like fb_iframe_widget" data-href="http://www.facebook.com/hayageek" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=445577382175430&amp;container_width=4&amp;href=http%3A%2F%2Fwww.facebook.com%2Fhayageek&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 87px; height: 20px;"><iframe name="fedf72c7b856ee" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 87px; height: 20px;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/like.htm" class="" height="1000px" frameborder="0" width="90px"></iframe></span></div></span> <span><iframe id="twitter-widget-0" scrolling="no" allowtransparency="true" class="twitter-follow-button twitter-follow-button-rendered" style="position: static; visibility: visible; width: 63px; height: 20px;" title="Twitter Follow Button" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/follow_button.htm" data-screen-name="hayageek" frameborder="0"></iframe></span> <span><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px;" id="___plusone_0"><iframe hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" id="I0_1481210216250" name="I0_1481210216250" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/fastbutton.htm" data-gapiattached="true" title="+1" frameborder="0" width="100%"></iframe></div> </span></div><div class="clearfix"></div></div><div class="logoright columns"><div class="topads pull-right"><div id="bsap_1289820" class="bsap bsap_1289820" data-serve="CAYIC2Y">
<style type="text/css">
div.bsap_1289820{width:100%;display:block;}div.bsap_1289820 a{width:728px;}div.bsap_1289820 a img{padding:0;}div.bsap_1289820 a em{font-style:normal;}div.bsap_1289820 a{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;}
div.bsap_1289820 img{border:0;clear:right;}
div.bsap_1289820 a.adhere{color:#666;font-weight:bold;font-size:12px;border:1px solid #ccc;background:#e7e7e7;text-align:center;}
div.bsap_1289820 a.adhere:hover{border:1px solid #999;background:#ddd;color:#333;}
div.bsap_1289820 iframe{display:block;font-size:11px;color:#888;font-family:verdana,sans-serif;margin:0;text-align:center;text-decoration:none;overflow:hidden;float:left;}div.bsap_1289820 a{line-height:100%;}div.bsap_1289820 a.adhere{width:728px;height:90px;line-height:720%;}html>body div.bsap_1289820 a.adhere{width:726px;height:88px;}div.bsap_1289820 img.s{height:0;width:0;}
</style>
<a href="http://srv.buysellads.com/ads/click/x/GTND423YC67DT27WCEYLYKQWFTYI6KQNCEYD5Z3JCEAD4KQNCYYIPKJKC6BDEKQLCTAI6K3EHJNCLSIZ" class="ad0 odd " title="Connect apps, databases, legacy systems all drop and drag in near real time" id="bsa_7005843" target="_blank" rel="nofollow">
<img src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/7005843-1473367509.png" alt="" height="90" width="728"></a>
<script type="text/javascript" id="auto_1" class="ignoreme"> if (typeof(BSACallback) !== 'undefined') BSACallback(); </script></div></div></div><div class="clearfix"></div></div><ul class="mcatlist l_tinynav1"><li class="cat-item cat-item-5"><a href="http://hayageek.com/category/coding/" title="Programming in PHP, Javascript, VB,C# , Jquery, ">Coding</a></li><li class="cat-item cat-item-4"><a href="http://hayageek.com/category/how/" title="How to guides">How</a></li><li class="cat-item cat-item-81"><a href="http://hayageek.com/category/security/">Security</a></li><li class="cat-item cat-item-8"><a href="http://hayageek.com/category/tutorial/" title="Tutorials  ">Tutorials</a></li></ul><select id="tinynav1" class="tinynav tinynav1"><option selected="selected">All Categories</option><option value="http://hayageek.com/category/coding/">Coding</option><option value="http://hayageek.com/category/how/">How</option><option value="http://hayageek.com/category/security/">Security</option><option value="http://hayageek.com/category/tutorial/">Tutorials</option></select></div></div><div class="container"><div id="wrap" class="row"><div id="content"><div class="singlebox"><div class="post hentry" id="1737"><h1 class="entry-title"><a href="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/">Two factor authentication with Google Authenticator and PHP</a></h1><div class="posthead"><div class="singlemeta entry-meta"> <span class="mauthor vcard">by <a class="url fn n" href="http://hayageek.com/author/rskusuma/" title="Posts by Ravishanker Kusuma">Ravishanker Kusuma</a> </span> <span class="mcat category">in <a rel="tag" href="http://hayageek.com/category/coding/" title="Coding">Coding</a>, <a rel="tag" href="http://hayageek.com/category/tutorial/" title="Tutorials">Tutorials</a> </span> <span class="mdate updated">Oct 20th 2015</span> · <span class="comword"><a href="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/#disqus_thread">2 Comments</a></span></div><div class="socialbox"> <span><div class="fb-like fb_iframe_widget" data-href="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" data-ref="oxp_single_top" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=445577382175430&amp;container_width=0&amp;href=http%3A%2F%2Fhayageek.com%2Ftwo-factor-authentication-with-google-authenticator-php%2F&amp;layout=button_count&amp;locale=en_US&amp;ref=oxp_single_top&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 80px; height: 20px;"><iframe name="f149589b953889e" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 80px; height: 20px;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/like_002.htm" class="" height="1000px" frameborder="0" width="90px"></iframe></span></div> </span> <span> <iframe id="twitter-widget-1" scrolling="no" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" style="position: static; visibility: visible; width: 61px; height: 20px;" title="Twitter Tweet Button" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/tweet_button.htm" data-url="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/" frameborder="0"></iframe> </span> <span><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px;" id="___plusone_1"><iframe hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" id="I1_1481210216303" name="I1_1481210216303" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/fastbutton_002.htm" data-gapiattached="true" title="+1" frameborder="0" width="100%"></iframe></div> </span><div class="clearfix"></div></div><div class="clearfix"></div></div><div class="singletopleft"><div class="singletopsiteads"> <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;" data-ad-client="ca-pub-0923466578214929" data-ad-slot="4221055227" data-adsbygoogle-status="done"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:300px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" height="250" frameborder="0" width="300"></iframe></ins></ins></ins><script>
try {
(adsbygoogle = window.adsbygoogle || []).push({});
} catch (err) {}
</script></div></div><div class="entry entry-content"><p class="fpara "></p><p>In
 this tutorial, I have explained how to add Two factor authentication 
with Google Authenticator and PHP . You can check official 
Google-Authentication project here. <a title="Two factor authentication with Google Authenticator" href="https://github.com/google/google-authenticator/" target="_blank">Github</a></p><p>Follow the steps.</p><p><strong>Step 1) </strong>Create a unique secret code of length 16 characters.<br> <a title="Two factor authentication with Google Authenticator Wrapper" href="https://github.com/PHPGangsta/GoogleAuthenticator" target="_blank">PHPGangsta</a> provides wrapper class for Google Authenticator. You can download using composer.</p><div><div id="highlighter_836949" class="syntaxhighlighter nogutter notranslate bash"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="bash plain">curl -sS https:</code><code class="bash plain">//getcomposer</code><code class="bash plain">.org</code><code class="bash plain">/installer</code> <code class="bash plain">| php</code></div><div class="line number2 index1 alt1"><code class="bash plain">php composer.phar require&nbsp; phpgangsta</code><code class="bash plain">/googleauthenticator</code><code class="bash plain">:dev-master</code></div></div></td></tr></tbody></table></div></div><p>Use the below code to generate the secret code.</p><div><div id="highlighter_520603" class="syntaxhighlighter nogutter notranslate php"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php keyword">require</code> <code class="php string">'vendor/autoload.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2"><code class="php variable">$authenticator</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">PHPGangsta_GoogleAuthenticator();</code></div><div class="line number4 index3 alt1"><code class="php variable">$secret</code> <code class="php plain">= </code><code class="php variable">$authenticator</code><code class="php plain">-&gt;createSecret();</code></div><div class="line number5 index4 alt2"><code class="php functions">echo</code> <code class="php string">"Secret: "</code><code class="php plain">.</code><code class="php variable">$secret</code><code class="php plain">;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p><strong>Step 2) </strong>Create a QR code withe the generated secret.</p><p>We need to prepare a QR code using the secret. If you want to read more about QR code generation for Google Authenticator. <a title="Two factor authentication with Google Authenticator Wiki" href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format" target="_blank">Github Wiki</a><br> You can use any QR code generator to generate the QR code, For this demo I am using Google charts.</p><div><div id="highlighter_58512" class="syntaxhighlighter notranslate actionscript3"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="actionscript3 plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="actionscript3 plain">require </code><code class="actionscript3 string">'vendor/autoload.php'</code><code class="actionscript3 plain">;</code></div><div class="line number3 index2 alt2"><code class="actionscript3 plain">$authenticator = </code><code class="actionscript3 keyword">new</code> <code class="actionscript3 plain">PHPGangsta_GoogleAuthenticator();</code></div><div class="line number4 index3 alt1"><code class="actionscript3 plain">$secret = $authenticator-&gt;createSecret();</code></div><div class="line number5 index4 alt2"><code class="actionscript3 plain">echo </code><code class="actionscript3 string">"Secret: "</code><code class="actionscript3 plain">.$secret.</code><code class="actionscript3 string">"\n"</code><code class="actionscript3 plain">;&nbsp; </code><code class="actionscript3 comments">//save this at server side</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="actionscript3 plain">$website = </code><code class="actionscript3 string">'http://hayageek.com'</code><code class="actionscript3 plain">; //Your Website</code></div><div class="line number9 index8 alt2"><code class="actionscript3 plain">$title= </code><code class="actionscript3 string">'Hayageek'</code><code class="actionscript3 plain">;</code></div><div class="line number10 index9 alt1"><code class="actionscript3 plain">$qrCodeUrl = $authenticator-&gt;getQRCodeGoogleUrl($title, $secret,$website);</code></div><div class="line number11 index10 alt2"><code class="actionscript3 plain">echo $qrCodeUrl;</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="actionscript3 plain">?&gt;</code></div></div></td></tr></tbody></table></div></div><p>&nbsp;</p><p><strong>Step 3)</strong> Generate TOTP (Time-Based One time password) using Google Authenticator App</p><p>Download the Google Authenticator app from <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&amp;hl=en" target="_blank">Google Play</a> or <a href="https://itunes.apple.com/en/app/google-authenticator/id388497605?mt=8" target="_blank">AppStore</a></p><p>Open
 the app and Click on ‘+’ Button, and scan the QR code generated using 
Google Charts. Authenticator app generates the TOTP for your website. 
TOTP will change for every 30 secs.</p><p><a href="http://cdn.hayageek.com/wp-content/uploads/2015/10/IMG_5413.png" class="hs-rsp-popup"><img class="alignnone size-medium wp-image-1739" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/IMG_5413-169x300.png" alt="Two factor authentication with Google Authenticator" height="300" width="169"></a></p><p><strong>Step 4)</strong> Verifying OTP at server side</p><div><div id="highlighter_618943" class="syntaxhighlighter nogutter notranslate php"><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php keyword">require</code> <code class="php string">'vendor/autoload.php'</code><code class="php plain">;</code></div><div class="line number3 index2 alt2"><code class="php variable">$authenticator</code> <code class="php plain">= </code><code class="php keyword">new</code> <code class="php plain">PHPGangsta_GoogleAuthenticator();</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="php variable">$secret</code> <code class="php plain">= </code><code class="php string">'3JMZE4ASZRIISJRI'</code><code class="php plain">; </code><code class="php comments">//This is used to generate QR code</code></div><div class="line number6 index5 alt1"><code class="php variable">$otp</code> <code class="php plain">= </code><code class="php string">'183036'</code> <code class="php plain">;</code><code class="php comments">//Generated by Authenticator.</code></div><div class="line number7 index6 alt2">&nbsp;</div><div class="line number8 index7 alt1"><code class="php variable">$tolerance</code> <code class="php plain">= 0;</code></div><div class="line number9 index8 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">//Every otp is valid for 30 sec.</code></div><div class="line number10 index9 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// If somebody provides OTP at 29th sec, by the time it reaches the server OTP is expired.</code></div><div class="line number11 index10 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">//So we can give tolerance =1, it will check current&nbsp; &amp; previous OTP.</code></div><div class="line number12 index11 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php comments">// tolerance =2, verifies current and last two OTPS</code></div><div class="line number13 index12 alt2">&nbsp;</div><div class="line number14 index13 alt1"><code class="php variable">$checkResult</code> <code class="php plain">= </code><code class="php variable">$authenticator</code><code class="php plain">-&gt;verifyCode(</code><code class="php variable">$secret</code><code class="php plain">, </code><code class="php variable">$otp</code><code class="php plain">, </code><code class="php variable">$tolerance</code><code class="php plain">);&nbsp;&nbsp;&nbsp; </code></div><div class="line number15 index14 alt2">&nbsp;</div><div class="line number16 index15 alt1"><code class="php keyword">if</code> <code class="php plain">(</code><code class="php variable">$checkResult</code><code class="php plain">) </code></div><div class="line number17 index16 alt2"><code class="php plain">{</code></div><div class="line number18 index17 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code> <code class="php string">'OTP is Validated Succesfully'</code><code class="php plain">;</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code>&nbsp;</div><div class="line number20 index19 alt1"><code class="php plain">} </code><code class="php keyword">else</code> <code class="php plain">{</code></div><div class="line number21 index20 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code> <code class="php string">'FAILED'</code><code class="php plain">;</code></div><div class="line number22 index21 alt1"><code class="php plain">}</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table></div></div><div class="demobtns"><a class="btn btn-danger" target="__blank" title="Two factor authentication with Google Authenticator Demo" href="http://hayageek.com/examples/php/google-authenticator/index.php"><i class="icon-eye"></i> Demo</a>&nbsp;<a class="btn btn-danger" target="__blank" title="Two factor authentication with Google Authenticator Download" href="http://cdn.hayageek.com/downloads/php/google-authenticator.zip"><i class="icon-download"></i> Download Source</a></div><p></p></div></div><div style="padding:0px;margin:0px;margin-left:-50px;"> <ins class="adsbygoogle" style="display:inline-block;width:970px;height:90px" data-ad-client="ca-pub-0923466578214929" data-ad-slot="6444020521" data-adsbygoogle-status="done"><ins id="aswift_1_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:970px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:970px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" height="90" frameborder="0" width="970"></iframe></ins></ins></ins><script>
try {
(adsbygoogle = window.adsbygoogle || []).push({});
} catch (err) {}
</script></div> <br><div class="authorbox"><div class="authorleft"><div class="authorimg"><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 290px; height: 106px;" id="___person_0"><iframe hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 290px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 106px;" tabindex="0" vspace="0" id="I3_1481210216404" name="I3_1481210216404" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/person.htm" data-gapiattached="true" title="+Badge" frameborder="0" width="100%"></iframe></div></div><div class="authorbio"> I am a Developer. My motto: <i>"Language is not a barrier" </i> <a rel="nofollow" target="_blank" href="http://hayageek.com/">http://hayageek.com</a><ul class="socialcircle"><li id="atwitter"><i class="icon-twitter"></i><a rel="nofollow" href="http://twitter.com/hayageek" title="Visit my Twitter" target="_blank">Twitter</a></li><li id="afacebook"><i class="icon-facebook"></i><a rel="nofollow" href="http://www.facebook.com/hayageek" title="Visit my Website" target="_blank">Facebook</a></li></ul><div class="clearfix"></div><h5>All posts by <a href="http://hayageek.com/author/rskusuma/" title="Posts by Ravishanker Kusuma">Ravishanker Kusuma</a></h5></div></div></div><div id="comment-area"><div id="disqus_thread" data-disqus-shortname="hayageek" data-disqus-url="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/"><iframe id="dsq-app1" name="dsq-app1" allowtransparency="true" scrolling="no" tabindex="0" title="Disqus" style="width: 1px ! important; min-width: 100% ! important; border: medium none ! important; overflow: hidden ! important; height: 680px ! important;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/a_003.htm" horizontalscrolling="no" verticalscrolling="no" frameborder="0" width="100%"></iframe></div></div><div class="footads"></div></div></div><div id="sidebar"><div id="sponsors" class="sidebox"><div class="sideads11"></div><div class="sideads1"></div></div><div class="sidebox allpick"><h2 class="opencon">Most Popular</h2><ul class="ourpick"><ul><li><div class="picktext"><h3><a title="jQuery AJAX Form Submit Example" href="http://hayageek.com/jquery-ajax-form-submit/">jQuery AJAX Form Submit Example</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="Facebook Javascript SDK Tutorial" href="http://hayageek.com/facebook-javascript-sdk/">Facebook Javascript SDK Tutorial</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="jQuery AJAX POST Example" href="http://hayageek.com/jquery-ajax-post/">jQuery AJAX POST Example</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="PHP CURL POST &amp; GET Examples – Submit Form using PHP CURL" href="http://hayageek.com/php-curl-post-get/">PHP CURL POST &amp; GET Examples – Submit Form using PHP CURL</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="How to Send Cross Domain AJAX Request with jQuery" href="http://hayageek.com/cross-domain-ajax-request-jquery/">How to Send Cross Domain AJAX Request with jQuery</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="Google URL Shortener API example" href="http://hayageek.com/google-url-shortener-api/">Google URL Shortener API example</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="jQuery Submit Form Example" href="http://hayageek.com/jquery-submit-form/">jQuery Submit Form Example</a></h3></div><div class="clearfix"></div></li><li><div class="picktext"><h3><a title="Drag and Drop File Upload jQuery Example" href="http://hayageek.com/drag-and-drop-file-upload-jquery/">Drag and Drop File Upload jQuery Example</a></h3></div><div class="clearfix"></div></li></ul></ul></div><hr><div class="ads" style="width:300px;height:250px;border:0px solid #F0E6E9;"><div id="bsap_1289817" class="bsap bsap_1289817" data-serve="CAYIC2E"><!-- no ad -->

<a href="http://www.buysellads.com/buy/detail/209882/zone/1289817?utm_source=site_209882&amp;utm_medium=website&amp;utm_campaign=imagetext&amp;utm_content=zone_1289817" class="adhere">Advertise Here</a>


<script type="text/javascript" id="auto_1" class="ignoreme"> if (typeof(BSACallback) !== 'undefined') BSACallback(); </script></div></div><hr><div class="sidebox allpick"><h2 class="opencon">TOPICS</h2><div class="sideads2"> <a href="http://hayageek.com/tag/android/" title="Android Tag" class="btn btn-tag">Android</a><a href="http://hayageek.com/tag/api/" title="API Tag" class="btn btn-tag">API</a><a href="http://hayageek.com/tag/bug-bounty/" title="Bug Bounty Tag" class="btn btn-tag">Bug Bounty</a><a href="http://hayageek.com/tag/css/" title="CSS Tag" class="btn btn-tag">CSS</a><a href="http://hayageek.com/tag/facebook/" title="Facebook Tag" class="btn btn-tag">Facebook</a><a href="http://hayageek.com/tag/gmail/" title="Gmail Tag" class="btn btn-tag">Gmail</a><a href="http://hayageek.com/tag/google/" title="Google Tag" class="btn btn-tag">Google</a><a href="http://hayageek.com/tag/internet/" title="Internet Tag" class="btn btn-tag">Internet</a><a href="http://hayageek.com/tag/ios/" title="iOS Tag" class="btn btn-tag">iOS</a><a href="http://hayageek.com/tag/java/" title="Java Tag" class="btn btn-tag">Java</a><a href="http://hayageek.com/tag/javascript/" title="Javascript Tag" class="btn btn-tag">Javascript</a><a href="http://hayageek.com/tag/jquery/" title="jQuery Tag" class="btn btn-tag">jQuery</a><a href="http://hayageek.com/tag/microsoft/" title="Microsoft Tag" class="btn btn-tag">Microsoft</a><a href="http://hayageek.com/tag/node-js/" title="Node.js Tag" class="btn btn-tag">Node.js</a><a href="http://hayageek.com/tag/objective-c/" title="Objective-C Tag" class="btn btn-tag">Objective-C</a><a href="http://hayageek.com/tag/openssl/" title="OpenSSL Tag" class="btn btn-tag">OpenSSL</a><a href="http://hayageek.com/tag/pdf/" title="Pdf Tag" class="btn btn-tag">Pdf</a><a href="http://hayageek.com/tag/php/" title="PHP Tag" class="btn btn-tag">PHP</a><a href="http://hayageek.com/tag/swift/" title="Swift Tag" class="btn btn-tag">Swift</a><a href="http://hayageek.com/tag/twitter/" title="Twitter Tag" class="btn btn-tag">Twitter</a><a href="http://hayageek.com/tag/url-shortener/" title="URL Shortener Tag" class="btn btn-tag">URL Shortener</a><a href="http://hayageek.com/tag/wordpress/" title="Wordpress Tag" class="btn btn-tag">Wordpress</a><a href="http://hayageek.com/tag/xss/" title="XSS Tag" class="btn btn-tag">XSS</a><a href="http://hayageek.com/tag/youtube/" title="youtube Tag" class="btn btn-tag">youtube</a></div></div><hr><div class="sidebox"><div class="sideads2"><div class="fb-like-box fb_iframe_widget" data-href="http://www.facebook.com/hayageek" data-width="300" data-height="300" data-colorscheme="light" data-show-faces="true" data-header="false" data-stream="false" data-show-border="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=445577382175430&amp;color_scheme=light&amp;container_width=306&amp;header=false&amp;height=300&amp;href=http%3A%2F%2Fwww.facebook.com%2Fhayageek&amp;locale=en_US&amp;sdk=joey&amp;show_border=false&amp;show_faces=true&amp;stream=false&amp;width=300"><span style="vertical-align: bottom; width: 300px; height: 214px;"><iframe name="f19312800775dfc" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like_box Facebook Social Plugin" style="border: medium none; visibility: visible; width: 300px; height: 214px;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/like_box.htm" class="" height="300px" frameborder="0" width="300px"></iframe></span></div></div></div><hr><div id="sticksideads-sticky-wrapper" class="sticky-wrapper" style="height: 503px;"><div id="sticksideads" class="sideadsstick" style="margin: 0px; padding: 0px;"><div class="sideadshead"><div class="adstitle">Advertisement</div><div class="advert"> <a href="https://buysellads.com/buy/detail/209882" rel="nofollow" target="_blank">Advertise with us</a></div><div class="clearfix"></div></div> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-0923466578214929" data-ad-slot="7798628030" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:280px;margin:0;padding:0;position:relative;visibility:visible;width:336px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" height="280" frameborder="0" width="336"></iframe></ins></ins></ins><hr><div class="sideads2"><div class="followus">Sharing is caring</div><span><div class="fb-like fb_iframe_widget" data-href="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/" data-send="false" data-layout="button_count" data-width="90" data-show-faces="false" fb-xfbml-state="rendered" fb-iframe-plugin-query="app_id=445577382175430&amp;container_width=306&amp;href=http%3A%2F%2Fhayageek.com%2Ftwo-factor-authentication-with-google-authenticator-php%2F&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=90"><span style="vertical-align: bottom; width: 80px; height: 20px;"><iframe name="f3595b9d46b6fc4" allowtransparency="true" allowfullscreen="true" scrolling="no" title="fb:like Facebook Social Plugin" style="border: medium none; visibility: visible; width: 80px; height: 20px;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/like_003.htm" class="" height="1000px" frameborder="0" width="90px"></iframe></span></div> </span> <span> <iframe id="twitter-widget-2" scrolling="no" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" style="position: static; visibility: visible; width: 61px; height: 20px;" title="Twitter Tweet Button" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/tweet_button_002.htm" data-url="http://hayageek.com/two-factor-authentication-with-google-authenticator-php/" frameborder="0"></iframe> </span> <span><div style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent none repeat scroll 0% 0%; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px;" id="___plusone_2"><iframe hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" id="I2_1481210216356" name="I2_1481210216356" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/fastbutton_003.htm" data-gapiattached="true" title="+1" frameborder="0" width="100%"></iframe></div> </span></div><hr><div class="sideads2"><div class="followus">Please consider donating!</div><form id="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post"> <input name="cmd" value="_xclick" type="hidden"> <input name="business" value="rskusuma@yahoo.com" type="hidden"> <input name="item_name" value="Support Hayageek.com" type="hidden"> <input name="buyer_credit_promo_code" value="" type="hidden"> <input name="buyer_credit_product_category" value="" type="hidden"> <input name="buyer_credit_shipping_method" value="" type="hidden"> <input name="buyer_credit_user_address_change" value="" type="hidden"> <input name="no_shipping" value="0" type="hidden"> <input name="no_note" value="1" type="hidden"> <input name="currency_code" value="USD" type="hidden"> <input name="tax" value="0" type="hidden"> <input name="lc" value="US" type="hidden"> <input name="bn" value="PP-DonationsBF" type="hidden"><div><input id="butt" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/btn_donate_SM.gif" name="submit" alt="Make payments with PayPal - it's fast, free and secure!" type="image" border="0"></div></form></div><hr> <b>Do you want to write articles in our Blog:</b> <br><a href="http://hayageek.com/contact/" "="">Contact Us</a></div></div></div><div class="clearfix"></div></div></div></div><div id="push"></div><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shCore.js"></script><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shAutoloader.js"></script><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/shBrushXml.js"></script><script type="text/javascript">//<![CDATA[
	SyntaxHighlighter.autoloader(
	"applescript	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAppleScript.js.gzip?ver=3.0"
	,"as3 actionscript3	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js.gzip?ver=3.0"
	,"bash shell	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js.gzip?ver=3.0"
	,"cf coldfusion	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js.gzip?ver=3.0"
	,"cpp c	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js.gzip?ver=3.0"
	,"c# c-sharp csharp	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js.gzip?ver=3.0"
	,"css	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js.gzip?ver=3.0"
	,"delphi pas pascal	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js.gzip?ver=3.0"
	,"diff patch	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js.gzip?ver=3.0"
	,"erl erlang	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js.gzip?ver=3.0"
	,"groovy	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js.gzip?ver=3.0"
	,"java	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js.gzip?ver=3.0"
	,"jfx javafx	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js.gzip?ver=3.0"
	,"js jscript javascript	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js.gzip?ver=3.0"
	,"perl pl	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js.gzip?ver=3.0"
	,"php	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js.gzip?ver=3.0"
	,"plain text	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js.gzip?ver=3.0"
	,"ps powershell	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js.gzip?ver=3.0"
	,"py python	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js.gzip?ver=3.0"
	,"rails ror ruby rb	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js.gzip?ver=3.0"
	,"sass scss	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSass.js.gzip?ver=3.0"
	,"scala	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js.gzip?ver=3.0"
	,"sql	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js.gzip?ver=3.0"
	,"vb vbnet	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js.gzip?ver=3.0"
	,"xml xhtml xslt html	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js.gzip?ver=3.0"
,"objc	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushObjC.js.gzip?ver=3.0","swift	http://cdn.hayageek.com/wp-content/plugins/wp-syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSwift.js.gzip?ver=3.0"	);
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['quick-code'] = true;
	SyntaxHighlighter.defaults['title'] = '';
	SyntaxHighlighter.defaults['class-name'] = 'notranslate';
	SyntaxHighlighter.defaults['collapse'] = false;
	SyntaxHighlighter.defaults['first-line'] = 1;
	SyntaxHighlighter.defaults['gutter'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['smart-tabs'] = true;
	SyntaxHighlighter.defaults['tab-size'] = 4;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = "Can't find brush for: ";
	SyntaxHighlighter.config.strings.brushNotHtmlScript = "Brush wasn't configured for html-script option: ";
	SyntaxHighlighter.all();
	
//]]></script><div id="footer"><div class="container"><div class="row"><div class="footleft"><ul class="footlink"><li><a href="http://hayageek.com/about/">About</a></li>·<li><a href="http://hayageek.com/contact/">Contact</a></li>·<li><a href="http://hayageek.com/write-for-us/">Write</a></li>·<li><a href="https://buysellads.com/buy/detail/209882" rel="nofollow" target="_blank">Advertise</a></li>·</ul><div class="copyright"> HayaGeek. Copyright © 2009 - 2014. All Rights Reserved.</div></div><div class="footright"><div class="footfree"><div class="footlogo"><p class="cdntext">Powered by:</p> <a href="http://www.wordpress.com/" target="_blank">Wordpress</a></div><div class="footlogo"><p class="fonttext">Fonts by:</p> <a rel="nofollow" href="http://fontdeck.com/" target="_blank">FontDeck</a></div></div><div class="backtop" style="display: none;"> <a href="#wrap" title="Back to Top"><i class="icon-up"></i></a></div></div><div class="clearfix"></div></div></div></div><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="http://staticxx.facebook.com/connect/xd_arbiter/r/_IDqWBiKXtV.js?version=42#channel=f2f644e212568fc&amp;origin=http%3A%2F%2Fhayageek.com" frameborder="0"></iframe><iframe name="fb_xdm_frame_https" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" style="border: medium none;" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/_IDqWBiKXtV_002.htm" frameborder="0"></iframe></div></div></div><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/jquery.js"></script><script type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/settings.js"></script><script async="" type="text/javascript" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/hs_rsp_popup.js"></script><script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'hayageek'; // required: replace example with your forum shortname
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//go.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script><script>
var disqus_shortname = 'hayageek';
var disqus_loaded=false;
if($("#disqus_thread").length > 0) {
    $(window).scroll(function () {
        if(!disqus_loaded) {
            disqus_loaded = true;
            /* * * DON'T EDIT BELOW THIS LINE * * */
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }
    });
}
</script><script type="text/javascript">
WebFontConfig = { fontdeck: { id: '45925' } };

(function() {
  var wf = document.createElement('script');
  wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
  '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
  wf.type = 'text/javascript';
  wf.async = 'true';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(wf, s);
})();
</script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37706919-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script><script>

$(document).ready(function()
{
    var options = {
        type: "scroll",
//        time: 2000, //in milli seconds        
        scripts: [
		"http://platform.twitter.com/widgets.js",
		"http://connect.facebook.net/en_US/all.js#xfbml=1&appId=445577382175430&version=2.0",
		"https://apis.google.com/js/plusone.js"
			],
        success: function () {
             FB.init({ appId:'445577382175430',status: true, cookie: true, xfbml: true,version:"v2.0" });
        }
    };
 
    $.lazyscript(options);
    });
</script><iframe style="display: none;"></iframe><iframe name="oauth2relay238472574" id="oauth2relay238472574" src="Two%20factor%20authentication%20with%20Google%20Authenticator%20&amp;%20PHP_files/postmessageRelay.htm" style="width: 1px; height: 1px; position: absolute; top: -100px;" tabindex="-1" aria-hidden="true"></iframe><iframe id="rufous-sandbox" scrolling="no" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: medium none;" title="Twitter analytics iframe" frameborder="0"></iframe></body></html>